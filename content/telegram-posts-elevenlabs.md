# Посты для Telegram: Кейс ElevenLabs Proxy

Копируй текст между линиями ▼▼▼ и ▲▲▲

---

## 1. Короткий пост для предпринимателей

▼▼▼ КОПИРОВАТЬ ОТСЮДА ▼▼▼

**Воскресенье. Сообщение от клиента: "Ничего не работает"**

Голосовой AI-помощник на сайте клиента из недвижимости перестал работать. Просто так. Без причины.

С VPN — работает. Без — нет.

Оказалось — ElevenLabs (американский сервис) начал блокировать Беларусь. Санкции. Без предупреждения.

Пока разбирались — каждый час сайт терял заявки.

**Что сделали:** За 70 минут подняли прокси-сервер в US. Виджет снова работает.

**Что это стоило:** +$7/месяц к инфраструктуре.

**Что это значит для вас:**

Если используете западные SaaS (OpenAI, ElevenLabs, Stripe, любые другие) — они могут отключить вас в любой момент. Юридически обязаны.

Это не вопрос "если". Это вопрос "когда".

План Б должен быть до того, как он понадобится.

—
_Строю AI-решения для бизнеса. Делюсь кейсами — и удачными, и не очень. Подписывайтесь, если интересно наблюдать за процессом._

▲▲▲ КОПИРОВАТЬ ДОСЮДА ▲▲▲

---

## 2. Короткий пост для разработчиков

▼▼▼ КОПИРОВАТЬ ОТСЮДА ▼▼▼

**Почему VPN помогает, а серверный прокси — нет?**

Интересная задачка на выходных.

Голосовой виджет (ElevenLabs) перестал работать у клиента из BY. С VPN — ок, без — падает.

Первая мысль: "Но у меня же сервер в US, API-запросы идут через него..."

А вот и нет.

**Проблема:**
```
API запрос: Браузер → Vercel (US) → ElevenLabs ✓
WebSocket:  Браузер → ElevenLabs напрямую ✗
```

`signed_url` возвращает `wss://api.elevenlabs.io/...` — и браузер открывает его сам. ElevenLabs видит IP клиента → блок.

**Решение:**

WebSocket прокси на Render (US). ~60 строк на Node.js.

Но был нюанс — ElevenLabs шлёт и JSON, и бинарные аудио-данные. Если не передать флаг `isBinary`:

```
JSON.parse("[object Blob]") → SyntaxError
```

Классика.

**Итог:** 70 минут, $7/мес, работает.

Код открытый, если кому надо — спрашивайте.

—
_Пишу про AI-интеграции, неочевидные баги и как их чинить. Если тоже строите что-то на ElevenLabs/OpenAI — подписывайтесь, будет полезно._

▲▲▲ КОПИРОВАТЬ ДОСЮДА ▲▲▲

---

## 3. Универсальный короткий пост

▼▼▼ КОПИРОВАТЬ ОТСЮДА ▼▼▼

**70 минут на спасение AI-виджета**

Воскресенье. Клиент пишет: "Голосовой помощник не работает".

Диагноз: ElevenLabs начал блокировать BY по санкциям.

Решение: WebSocket прокси через US-сервер.

Результат: Работает. +$7/мес.

**Урок:** Западные SaaS могут отключить без предупреждения. План Б нужен заранее.

—
_Строю AI-продукты, делюсь реальными кейсами. Подписывайтесь — тут без воды._

▲▲▲ КОПИРОВАТЬ ДОСЮДА ▲▲▲

---

## 4. Лонгрид для Telegram

▼▼▼ КОПИРОВАТЬ ОТСЮДА ▼▼▼

**Кейс: Голосовой AI-помощник перестал работать. Как мы починили за 70 минут**

_TL;DR_
Воскресенье. Сообщение от клиента: "Виджет не работает". С VPN — работает, без — нет. Причина — санкции США против ElevenLabs. Решение — WebSocket прокси через US-сервер. Время на фикс — 70 минут. Доп. расходы — $7/мес.

———

**Предыстория**

Клиент из сферы недвижимости (название под NDA). На сайте установлен голосовой AI-помощник — виджет, который консультирует посетителей и собирает заявки. Технология — ElevenLabs Conversational AI.

Работало стабильно несколько месяцев. До вчерашнего дня.

———

**Проблема**

_"Виджет перестал работать. С VPN работает, без VPN — нет"_

Классика: работало → сломалось → ничего не меняли.

———

**Для бизнеса: почему это критично**

Что теряет бизнес, когда виджет не работает:
• Упущенные заявки — посетители уходят без консультации
• Репутация — "у них там что-то сломано"
• Время менеджеров — ручная обработка вместо автоматизации

Риски использования западных SaaS:
Американские компании обязаны соблюдать санкции. ElevenLabs, OpenAI, Anthropic — все под этим давлением. В любой момент могут:
• Заблокировать по геолокации
• Отключить аккаунт
• Изменить условия

**Вывод для бизнеса:** Всегда иметь план Б.

———

**Диагностика**

Первая мысль — проблема на нашей стороне.

Проверили:
• Сервер — работает ✓
• API — отвечает ✓
• Ключи — валидные ✓
• Логи — без ошибок ✓

Копнули в документацию ElevenLabs:

_ElevenLabs блокирует доступ из Беларуси._

Не провайдер. Не государство. Сам сервис. Санкции США — компания юридически обязана блокировать пользователей из: Беларусь, Россия, Иран, Куба, КНДР, Сирия, Крым.

**Почему раньше работало?**
ElevenLabs периодически обновляет базы IP-адресов. Видимо, добавили новые диапазоны белорусских провайдеров.

———

**Для разработчиков: техническая часть**

Архитектура до поломки:
```
Браузер (BY) → Vercel (US) → ElevenLabs API
         ↓
    WebSocket НАПРЯМУЮ → ElevenLabs
    IP = BY = BLOCKED ❌
```

**Проблема:** Браузер устанавливает прямое WebSocket-соединение с ElevenLabs. Сервер ElevenLabs видит белорусский IP → отказ.

**Решение: WebSocket Proxy**
```
Браузер (BY) → Render Proxy (US) → ElevenLabs API
                IP = US = OK ✓
```

Ключевые моменты:

**1. Прокси на Node.js (~60 строк)**

Критично: сохранять тип сообщения (text vs binary)
```
clientWs.on('message', (data, isBinary) => {
  elevenLabsWs.send(data, { binary: isBinary });
});
```

ElevenLabs шлёт два типа сообщений:
• `text` — JSON команды
• `binary` — аудио данные

Если не передать флаг `isBinary` — клиент падает:
`JSON.parse("[object Blob]") → SyntaxError`

**2. Хостинг: Render (US регион)**
• Free план не подходит — обрывает WebSocket через 5 минут
• Starter план ($7/мес) — без лимитов

———

**Для энтузиастов: как это работает под капотом**

_Почему VPN помогает, а прокси на сервере — нет?_

Многие думают: "У меня же сервер в US, почему блокирует?"

**Ответ:** API-запросы и WebSocket — разные вещи.

1. **API-запрос** `/api/signed-url` → идёт через ваш сервер → IP сервера (US) → OK
2. **WebSocket соединение** → устанавливается браузером напрямую → IP пользователя (BY) → BLOCK

`signed_url` возвращает:
`wss://api.elevenlabs.io/v1/convai/conversation?agent_id=xxx`

Браузер открывает этот URL напрямую. ElevenLabs видит откуда пришёл запрос.

**Почему нельзя просто nginx proxy?**
WebSocket — это persistent connection с двусторонним обменом. Обычный HTTP reverse proxy не работает. Нужен именно WebSocket proxy.

———

**Результат**

Статус: Виджет работает. Без VPN. Из Беларуси.

Затраченное время:
• Диагностика и исследование — 15 мин
• Разработка прокси — 20 мин
• Деплой и настройка — 15 мин
• Отладка бинарных данных — 20 мин
• **Итого — 70 мин**

Дополнительные расходы: **+$7/месяц**

———

**Выводы**

_Для бизнеса:_
• Западные SaaS могут отключить в любой момент — имейте план Б
• Стоимость простоя часто выше стоимости резервных решений

_Для разработчиков:_
• WebSocket ≠ HTTP — нужен специализированный прокси
• Binary vs Text — критично для аудио/видео приложений
• Serverless (Vercel) не поддерживает WebSocket

_Для энтузиастов:_
• Санкции работают на уровне IP геолокации
• Прокси в правильном регионе решает большинство блокировок

———

**Технический стек:**
• Прокси: Node.js + ws library
• Хостинг прокси: Render (Oregon, US)
• Основной проект: Next.js на Vercel
• Голосовой AI: ElevenLabs Conversational AI

—
_Столкнулись с похожей проблемой блокировок? Пишите — разберёмся._

#кейс #devops #elevenlabs #санкции #websocket #proxy #ai

▲▲▲ КОПИРОВАТЬ ДОСЮДА ▲▲▲
